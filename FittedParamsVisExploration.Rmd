---
title: "Fitted PBE parameters exploration"
author: "Dmitry A. Grechka"
date: "July 6, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(ggplot2)

run16_v_x <- c(0,1.13312,20)
run16_v_y <- c(0.219381,0.229429,0.328992)
run16_v_t <- data.frame(x=run16_v_x,y=run16_v_y)
run16_vb <- 3.18886e-253

run16_v_model <- lm(y ~ poly(x,2),data=run16_v_t)
run16_v_model_pred <- function(x) {
  predict(run16_v_model,newdata = data.frame(x=x))
  }


run17_v_x <- c(0,9.45249e-98,20)
run17_v_y <- c(0.135636,0.180604,0.443775)
run17_v_t <- data.frame(x=run17_v_x,y=run17_v_y)
run17_vb <- 0.267058

run17_v_model <- lm(y ~ poly(x,2),data=run17_v_t)
run17_v_model_pred <- function(x) {
  predict(run17_v_model,newdata = data.frame(x=x))
  }



run18_v_x <- c(0,1.13312,20)
run18_v_y <- c(0.219381,0.229429,0.328992)
run18_v_t <- data.frame(x=run18_v_x,y=run18_v_y)
run18_vb <- 3.18886e-253

run18_v_model <- lm(y ~ poly(x,2),data=run18_v_t)
run18_v_model_pred <- function(x) {
  predict(run18_v_model,newdata = data.frame(x=x))
  }




linetype_scale <- c('1'='solid','2'='dashed')
linetype_scale_labels <- c('1'='burst func','2'='background')
color_scale <- c('16'='red','17'='green','18'='blue')
color_scale_labels <- c('16'='run 16','17'='run 17','18'='run 18')


a = ggplot()+
  scale_linetype_manual(values= linetype_scale,labels=linetype_scale_labels)+
  scale_color_manual(values= color_scale,labels=color_scale_labels)+
  geom_point(data=run16_v_t, aes(x=x, y=y,color='16'))+
  stat_function(data=run16_v_t,aes(x,linetype='1',color='16'),fun=run16_v_model_pred) +
  geom_hline(aes(yintercept=run16_vb,linetype='2',color='16'))+
  
  geom_point(data=run17_v_t, aes(x=x, y=y,color='17'))+
  stat_function(data=run17_v_t,aes(x,linetype='1',color='17'),fun=run17_v_model_pred) +
  geom_hline(aes(yintercept=run17_vb,linetype='2',color='17'))

print(a)
```
